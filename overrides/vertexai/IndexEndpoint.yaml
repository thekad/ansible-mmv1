---
examples:
  - name: 'vertex_ai_index_endpoint_with_public_endpoint'
    exclude_test: true
  - name: 'vertex_ai_index_endpoint_with_psc'
    _drop: true
  - name: 'vertex_ai_index_endpoint_with_false_psc'
    _drop: true
custom_code:
  pre_read: |
    # for this module, we're hitting the list endpoint and filtering on display name
    read_uri = f"{op_configs.base_url.uri}?filter=displayName={params.get("display_name")}"
  post_read: |
    # if there are existing indexes, the call would have returned a list
    if not gcp.empty(existing_obj):
        for idx in existing_obj.get("indexEndpoints", []):
            if idx.get("displayName") == params.get("display_name"):
                existing_obj = idx
                break
  pre_update: |
    # need to set to the required parameter "name" to the existing resource name
    params["name"] = existing_obj["name"].split("/")[-1]

    # finally, need to build the updateMask for the fields in our module
    update_uri += f"?updateMask={','.join(resource.dot_fields())}"

  pre_delete: |
    # need to set to the required parameter "name" to the existing resource name
    params["name"] = existing_obj["name"].split("/")[-1]
