- name: Create Featurestore with fixed node count
  google.cloud.gcp_vertexai_featurestore:
    state: present
    name: "{{`{{ resource_name | regex_replace('-', '_') }}`}}"
    region: us-central1
    online_serving_config:
        fixed_node_count: 1
    project: "{{`{{ gcp_project }}`}}"
    auth_kind: "{{`{{ gcp_cred_kind }}`}}"
    service_account_file: "{{`{{ gcp_cred_file }}`}}"
  register: _myfs

- name: Print Featurestore
  ansible.builtin.debug:
    var: _myfs

- name: Run assertions
  ansible.builtin.assert:
    that:
      - _myfs.changed == true

- name: Delete Featurestore
  google.cloud.gcp_vertexai_featurestore:
    state: absent
    name: "{{`{{ _myfs.name }}`}}"
    region: us-central1
    force_destroy: true
    project: "{{`{{ gcp_project }}`}}"
    auth_kind: "{{`{{ gcp_cred_kind }}`}}"
    service_account_file: "{{`{{ gcp_cred_file }}`}}"
  register: _myfs

- name: Print Featurestore
  ansible.builtin.debug:
    var: _myfs